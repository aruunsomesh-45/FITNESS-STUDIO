[
  {
    "id": "TC001",
    "title": "Contact Form: Successful Submission with Valid Data",
    "description": "Verify that the contact form submits successfully when all fields are valid, and the backend returns success with the message ID.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Navigate to the contact form page"
      },
      {
        "type": "action",
        "description": "Fill in Name field with a valid string between 2 and 100 characters"
      },
      {
        "type": "action",
        "description": "Fill in Email field with a valid email address under 255 characters"
      },
      {
        "type": "action",
        "description": "Select a valid Subject from ['General Inquiry', 'Membership', 'Personal Training', 'Careers']"
      },
      {
        "type": "action",
        "description": "Fill in Message field with a valid string between 10 and 1000 characters"
      },
      {
        "type": "action",
        "description": "Submit the contact form"
      },
      {
        "type": "assertion",
        "description": "Verify the API returns HTTP status 201 and a JSON response containing success=true, message text, and a valid UUID id"
      },
      {
        "type": "assertion",
        "description": "Verify the form resets to empty fields"
      },
      {
        "type": "assertion",
        "description": "Verify the frontend displays a success notification to the user"
      }
    ]
  },
  {
    "id": "TC002",
    "title": "Contact Form: Client-Side Validation for Mandatory Fields",
    "description": "Verify that the form enforces field requirements with appropriate client-side validation errors when fields are missing or invalid.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Navigate to the contact form page"
      },
      {
        "type": "action",
        "description": "Leave all fields empty and attempt to submit the form"
      },
      {
        "type": "assertion",
        "description": "Verify that client-side validation errors are shown for Name, Email, Subject, and Message fields"
      },
      {
        "type": "action",
        "description": "Enter invalid email format and invalid lengths (e.g., Name with 1 character, Message with 5 characters)"
      },
      {
        "type": "assertion",
        "description": "Verify client-side validation error messages for invalid email and length constraints on Name and Message fields"
      },
      {
        "type": "action",
        "description": "Select an invalid subject not in the allowed enum"
      },
      {
        "type": "assertion",
        "description": "Verify the subject field enforces allowed values (subject dropdown or validation error)"
      }
    ]
  },
  {
    "id": "TC003",
    "title": "Contact Form: Server-Side Validation Error Handling",
    "description": "Verify that the POST API rejects invalid data with HTTP 400 responses containing descriptive error messages.",
    "category": "error handling",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send POST request to /api/contact with missing required fields"
      },
      {
        "type": "assertion",
        "description": "Verify response status is 400 with error messages indicating missing fields"
      },
      {
        "type": "action",
        "description": "Send POST request with invalid email format"
      },
      {
        "type": "assertion",
        "description": "Verify response status is 400 with descriptive error about email format"
      },
      {
        "type": "action",
        "description": "Send POST request with subject value outside allowed enum"
      },
      {
        "type": "assertion",
        "description": "Verify response status is 400 indicating invalid subject"
      },
      {
        "type": "action",
        "description": "Send POST request with message shorter than 10 characters"
      },
      {
        "type": "assertion",
        "description": "Verify response status is 400 with appropriate error about message length"
      }
    ]
  },
  {
    "id": "TC004",
    "title": "Contact Form: Persistence Verification in Supabase Database",
    "description": "Verify that successfully submitted contact form data is correctly saved in the 'contact_messages' Supabase table with expected schema alignment.",
    "category": "integration",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Submit a valid contact form via POST /api/contact"
      },
      {
        "type": "assertion",
        "description": "Verify API returns HTTP 201 with a UUID message ID"
      },
      {
        "type": "action",
        "description": "Query the Supabase 'contact_messages' table for the message by returned ID"
      },
      {
        "type": "assertion",
        "description": "Verify stored record fields: full_name, email, subject, message match submitted data"
      },
      {
        "type": "assertion",
        "description": "Verify the created_at timestamp is present and valid ISO date-time string"
      }
    ]
  },
  {
    "id": "TC005",
    "title": "API Endpoint: Fetch Recent Contact Messages with Valid Admin API Key",
    "description": "Verify GET /api/contact returns the 20 most recent contact messages when requested with valid API key authentication.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send GET request to /api/contact with a valid x-api-key header matching ADMIN_API_KEY"
      },
      {
        "type": "assertion",
        "description": "Verify response status is 200"
      },
      {
        "type": "assertion",
        "description": "Verify response JSON contains an array 'messages' with up to 20 entries"
      },
      {
        "type": "assertion",
        "description": "Verify each message has 'id' (UUID), 'full_name', valid 'email', valid 'subject', 'message', and 'created_at' fields"
      },
      {
        "type": "assertion",
        "description": "Verify messages are sorted by 'created_at' descending (most recent first)"
      }
    ]
  },
  {
    "id": "TC006",
    "title": "API Endpoint: Refuse Fetching Contact Messages Without or With Invalid API Key",
    "description": "Verify that GET /api/contact returns HTTP 401 Unauthorized when called without an API key or with an invalid API key",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send GET request to /api/contact with no x-api-key header"
      },
      {
        "type": "assertion",
        "description": "Verify response status is 401 Unauthorized"
      },
      {
        "type": "action",
        "description": "Send GET request to /api/contact with an invalid x-api-key header"
      },
      {
        "type": "assertion",
        "description": "Verify response status is 401 Unauthorized"
      }
    ]
  },
  {
    "id": "TC007",
    "title": "Supabase Client Initialization Failure Handling",
    "description": "Verify the system handles misconfigured or missing environment variables for Supabase client setup gracefully without crashing.",
    "category": "error handling",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Start the application with environment variables for Supabase URL or key missing or empty"
      },
      {
        "type": "assertion",
        "description": "Verify Supabase client initialization fails gracefully with logged errors or controlled exceptions"
      },
      {
        "type": "assertion",
        "description": "Verify API endpoints return meaningful error messages indicating configuration issues"
      }
    ]
  },
  {
    "id": "TC008",
    "title": "Contact Form: Edge Case Input Length Boundaries",
    "description": "Verify form validation and API accept inputs at exact minimum and maximum length boundaries for each field.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Input Name with exactly 2 characters and 100 characters"
      },
      {
        "type": "action",
        "description": "Input Email with valid email and 255 character max length"
      },
      {
        "type": "action",
        "description": "Input Message with exactly 10 characters and 1000 characters"
      },
      {
        "type": "action",
        "description": "Submit form"
      },
      {
        "type": "assertion",
        "description": "Verify API accepts the inputs and responds with HTTP 201 and message ID"
      }
    ]
  },
  {
    "id": "TC009",
    "title": "Contact Form: Cross-Site Scripting (XSS) Prevention and Sanitization",
    "description": "Verify user inputs containing script tags or code are sanitized and do not cause XSS vulnerabilities after submission and database storage.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Fill the contact form fields with inputs containing HTML or script tags (e.g., <script>alert(1)</script>)"
      },
      {
        "type": "action",
        "description": "Submit the contact form"
      },
      {
        "type": "assertion",
        "description": "Verify API returns HTTP 201 success"
      },
      {
        "type": "action",
        "description": "Fetch the stored message from Supabase database"
      },
      {
        "type": "assertion",
        "description": "Verify that stored data is sanitized and does not include raw script tags or executable code"
      }
    ]
  },
  {
    "id": "TC010",
    "title": "Contact Form: Server Error Handling on Database Failures",
    "description": "Simulate server or database failure during POST submission and verify API returns HTTP 500 error with appropriate message.",
    "category": "error handling",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Trigger a POST /api/contact submission that causes database error (e.g., database connection failure)"
      },
      {
        "type": "assertion",
        "description": "Verify API returns HTTP 500 with server error message"
      },
      {
        "type": "assertion",
        "description": "Verify frontend displays an error notification to the user"
      }
    ]
  },
  {
    "id": "TC011",
    "title": "Contact Form: Verify Real-Time Client-Side Validation Feedback",
    "description": "Verify that as the user types into each field, real-time validation messages appear and disappear appropriately according to field input validity.",
    "category": "ui",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Navigate to the contact form page"
      },
      {
        "type": "action",
        "description": "Focus and type invalid inputs in each field and verify error messages appear immediately"
      },
      {
        "type": "action",
        "description": "Correct the inputs and verify error messages disappear instantly"
      }
    ]
  },
  {
    "id": "TC012",
    "title": "Contact Form: Form Reset Behavior After Successful Submission",
    "description": "Verify that the contact form resets all fields and validation states after a successful submission.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Submit a valid contact form"
      },
      {
        "type": "assertion",
        "description": "Verify all form input fields are cleared"
      },
      {
        "type": "assertion",
        "description": "Verify that validation error messages are reset and no errors display"
      }
    ]
  },
  {
    "id": "TC013",
    "title": "Admin API Key Security: Verify Different Roles Cannot Fetch Messages Without Key",
    "description": "Verify that users without a valid API key (including anonymous or logged-in site users) cannot access GET /api/contact messages.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send GET /api/contact request as an anonymous user without x-api-key header"
      },
      {
        "type": "assertion",
        "description": "Verify response is 401 Unauthorized"
      },
      {
        "type": "action",
        "description": "Send GET /api/contact with incorrect or expired API keys"
      },
      {
        "type": "assertion",
        "description": "Verify response is 401 Unauthorized"
      },
      {
        "type": "action",
        "description": "Send GET /api/contact with valid API key"
      },
      {
        "type": "assertion",
        "description": "Verify response is 200 OK"
      }
    ]
  }
]
